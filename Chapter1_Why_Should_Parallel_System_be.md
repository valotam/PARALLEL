---
title: "Parallel Programming"
output: pdf_document
mainfont: D2Coding
---

# 왜 병렬 컴퓨팅인가?

1.   싱글 프로세서 시스템으로도 충분히 빠르지 않은가?
2.   왜 병렬 시스템을 구축해야 하는가? 왜 다중 프로세서로 구성된 시스템을 구축해야 하는가?
3.   왜 시리얼 프로그램을 현재 다중 프로세사가 잘 사용될 수 있는 병렬 프로그램으로 자동으로 변환해 주는 프로그램을 만들 수 없는가?

## 성능 증가의 필요성

![](images/2018/02/compare.png)

## 병렬 시스템을 구축해야 하는 이유

Monolithic processor의 한계가 존재한다.
그로 인한 parallelism multicore processor의 등장

## 병렬화 프로그래밍이 필요한 이유

병렬 부분을 순차적으로 실행하도록 작성하면 상당히 비효율적인 코드가 된다.

시리얼 프로그램의 효율적인 병렬 구현은 각 단계별로 효율적으로 병렬화한다고 해서 얻어지는 것은 아니다. 오히려 가장 최고의 병렬화는 각 단계 이전에 전체적으로 완전히 새로운 알고리즘을 개발하는 것이 더 최선의 방법일 수도 있다. 예를 들어, $n$개의 값을 계산하고 그 값을 덧셈하는 경우를 가정해 보자.
아래의 시리얼 코드로 원하는 결과를 얻을 수 있다.

```cpp
sum = 0;
for (i = 0; i < n; i++) {
  x = Compute_next_value(...);
  sum += x;
}
```

이제 $p$개의 코어가 있고, $p$는 $n$ 보다는 훨씬 작다고 가정해 보자. 각 코어는 $\frac{n}{p}$ 의 수만큼 부분 합의 형태로 변경할 수 있다.

```cpp
my_sum = 0;
my_first_i = ...;
my_last_i = ...;
for (my_i = my_first_i; my_i < my_last_i; my_i++) {
  my_x = Compute_next_value(...);
  my_sum += my_x;
}
```

여기서 my_라고 하는 접두어는 각 코어가 자신의 로컬 변수 혹은 프라이빗 변수를 사용하며, 각 코어는 이 코드 블록을 다른 코어와는 상관없이 독립적으로 실행한다는 것을 의미한다.

## 병렬화 프로그램을 작성하는 방법

코어에서 동작하는 각각의 작업량을 partitioning 한다는 기본적인 개념에 따라 몇 가지로 다르게 나타난다. 크게 보면 task-parallelism 과 data-parallelism 두 가지 방법이 있다.

-   Task-parallelism: 문제를 해결하기 위해 여러 가지 태스크를 각 코어에 할당하는 방법
-   Data-parallelism: 문제를 해결하기 위해 사용할 데이터를 쪼개어 각 코어에 파티셔닝하는 방법

## 배울 내용

명시적(explicit) 병렬화 프로그램을 작성하는 방법에 대해 구체적으로 알아보기로 하자.
목적은 C언어와 세 가지의 서로 다른 C 확장 기술인 MPI(Message-Passing Interface), Pthreads(POSIX threads), 그리고 OpenMP 사용하여 병렬 컴퓨터에서 프로그래밍하는 기본 개념에 대해 배워 보는 것이다.

세 가지를 다루어 보는 이유는 병렬 시스템의 두 가지 중요한 타입이 있는데 공유 메모리(shared-memory) 시스템과 분산 메모리(distributed-memory) 시스템이다.

-   공유 메모리: 코어는 컴퓨터의 메모리를 공유하며, 특히 각 코어는 각 메모리의 주소에 읽고 쓸 수 있다. 공유 메모리 시스템에서는 공유 메모리 주소를 액세스 하거나 업데이트하면서 각 코어들 간의 협업을 할 수 있도록 한다. (e.g. Pthreads and OpenMP)

-   분산 메모리: 각 코어는 자신만의 메모리, 즉 private 메모리를 갖고 있으며, 코어들 간에는 네트워크를 통해 메시지를 전송하는 등의 방법을 통해 명시적으로 통신해야 한다. (e.g. MPI)

OpenMP는 C언어의 상위 레벨 확장이어서 loop를 하나의 디렉티브(directive)를 사용하여 "병렬화"할 수 있다.

반면에, Pthreads를 사용하면 더 로 레벨의 병렬화 기법을 제공해서 다른 프로그램을 병렬화 하기 쉽도록 해준다.

## 병행, 병렬, 분산

-   병행 컴퓨팅(concurrent computing): 하나의 프로그램에서 일정한 짧은 기간에 여러 개의 태스크가 동작하는 것
-   병렬 컴퓨팅(parallel computing): 하나의 프로그램에서 어떤 문제를 해결하기 위해 여려 개의 태스크가 밀접하게 연합하는 것
-   분산 컴퓨팅(distributed computing): 하나의 프로그램에서 어떤 문제를 해결하기 위해 다른 프로그램과 연합하는 것
